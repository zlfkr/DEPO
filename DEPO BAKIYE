 CREATE VIEW _DEPO_BAKIYE AS
SELECT C.STOK_KODU,B.STOK_ADI,C.DEPO0,c.DEPO1,c.DEPO2
FROM (SELECT A.STOK_KODU
,SUM(CASE WHEN A.DEPO_KODU=0 THEN A.TOP_GIRIS_MIK-A.TOP_CIKIS_MIK ELSE 0 END ) DEPO0
,SUM(CASE WHEN A.DEPO_KODU=1 THEN A.TOP_GIRIS_MIK-A.TOP_CIKIS_MIK ELSE 0 END ) DEPO1
,SUM(CASE WHEN A.DEPO_KODU=2 THEN A.TOP_GIRIS_MIK-A.TOP_CIKIS_MIK ELSE 0 END ) DEPO2
FROM TBLSTOKPH A
GROUP BY A.STOK_KODU) C
LEFT JOIN TBLSTSABIT B ON C.STOK_KODU=B.STOK_KODU
